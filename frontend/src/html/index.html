<!DOCTYPE html>
<html lang="en">
  <title> </title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://unpkg.com/tachyons/css/tachyons.min.css">
  <style>
.board {
  user-select: none;
}

text {
  font-family: helvetica, sans-serif;
  font-weight: bold;
}
body {
  background-color: #1a1a1a;
  color: white;
}
a {
  color: white;
}
.board {
  display: flex;
  justify-content: center;
}
rect {
  shape-rendering: crispEdges;
}
  </style>
  <body>
    <div id='elm'></div>
    <!--
    <div class='board' id='board'>
    </div>
    -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
<script src="https://d3js.org/d3-selection.v1.min.js"></script>
<script src="https://d3js.org/d3-drag.v1.min.js"></script>
<script src="https://d3js.org/d3-transition.v1.min.js"></script>
<script src="/app.js"></script>
<script src="/elm.js"></script>
  <script>
    customElements.define('licross-game-area', class extends HTMLElement {
      connectedCallback() {
        let container = d3.select(this)
          .append('div')
            .attr('id', 'board')
            .attr('class', 'board')

        container.append('svg')
          .call(responsify)

        d3.json("http://localhost:8080/example").then(function (response) {
          boardData = []
          tileData = []
          let tileId = 0
          response.board.forEach(space => {
            if (space.letter) {
              tileId += 1;
              tileData.push(
                {
                  "id": tileId,
                  "letter": space.letter,
                  "score": space.score,
                  "location": ["board", [space.x, space.y]], "moveable": false
                }
              )
            }

            const {x, y, bonus, ...partial} = space;

            boardData.push({ x, y, bonus})
          })
          console.log(tileData)
          redraw(boardData)
        })
      }

      get gameId() {
        console.log("get game id")
        return this._gameId;
      }

      set gameId(id) {
        console.log("set game id", id)
        this._gameId = id
      }
    })
    var app = Elm.Main.init({
      node: document.getElementById('elm')
    });
  </script>

  </body>
</html>
